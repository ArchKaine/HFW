<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Comprehensive design document for the HFW Shadow Fleet, an Anvil Aerospace subsidiary project. Details include genesis, variants, specifications, and operational doctrines.">
  <title>HFW Shadow Fleet - Comprehensive Design Document</title>

  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

  <style>
    /* === Integrated Stylesheet === */

    /* --- Base Styles & Full Viewport Setup --- */
    html,
    body {
      height: 100%;
      width: 100%;
      margin: 0;
      padding: 0;
      overflow-y: auto;
      overflow-x: hidden;
      font-family: "Segoe UI", "Roboto", "Helvetica Neue", sans-serif;
      background-color: #07090D;
      color: #f0f0f0;
      box-sizing: border-box;
    }

    *,
    *::before,
    *::after {
      box-sizing: inherit;
    }

    /* Base layout for Mobile First */
    .spectre-post-container {
      display: grid !important;
      grid-template-areas:
        "header"
        "content"
        "aside";
      grid-template-rows: auto 1fr auto;
      grid-template-columns: 1fr;
      gap: 0;
      min-height: 100vh;
      width: 100%;
      max-width: 1920px;
      margin: 0 auto;
      font-size: 18px;
      line-height: 1.6;
      background-color: #0b0e13;
    }

    /* Grid area assignments */
    .spectre-post-container>header {
      grid-area: header;
      background-color: #1a1a1a;
      padding: 1rem 2rem;
      text-align: center;
      border-bottom: 1px solid #2a2a2a;
      position: relative;
    }

    .spectre-post-container>nav {
      grid-area: nav;
    }

    .spectre-post-container>.container {
      grid-area: content;
    }

    .spectre-post-container>.spectre-post-aside {
      grid-area: aside;
    }

    /* Header Styling */
    .spectre-post-container header h1 {
      color: #ff4c4c;
      font-family: "Orbitron", sans-serif;
      margin: 0;
      font-size: 2.5rem;
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
    }

    /* Nav and Aside Styling */
    .spectre-post-container>nav,
    .spectre-post-container>.spectre-post-aside {
      background-color: #111;
    }

    .spectre-post-container>.spectre-post-aside {
      border-left: 2px solid #ff4c4c;
    }

    /* Inner scroll wrappers for nav and aside */
    .nav-scroll-wrapper,
    .aside-scroll-wrapper {
      height: 100%;
      overflow-y: auto;
      padding: 1rem;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
    }

    /* Custom scrollbar styling */
    .nav-scroll-wrapper::-webkit-scrollbar,
    .aside-scroll-wrapper::-webkit-scrollbar {
      width: 8px;
    }

    .nav-scroll-wrapper::-webkit-scrollbar-track,
    .aside-scroll-wrapper::-webkit-scrollbar-track {
      background: #1a1a1a;
    }

    .nav-scroll-wrapper::-webkit-scrollbar-thumb,
    .aside-scroll-wrapper::-webkit-scrollbar-thumb {
      background-color: #ff4c4c;
      border-radius: 4px;
      border: 1px solid #0b0e13;
    }

    .nav-scroll-wrapper,
    .aside-scroll-wrapper {
      scrollbar-width: thin;
      scrollbar-color: #ff4c4c #1a1a1a;
    }

    /* Nav Logo */
    .spectre-post-container>nav .nav-scroll-wrapper .nav-logo {
      padding: 0.5rem 0;
      text-align: center;
      flex-shrink: 0;
    }

    .spectre-post-container>nav .nav-scroll-wrapper .nav-logo-top {
      padding-bottom: 1rem;
      border-bottom: 1px solid #333;
    }

    .spectre-post-container>nav .nav-scroll-wrapper .nav-logo img {
      display: block;
      max-width: 150px;
      max-height: 150px;
      width: auto;
      height: auto;
      margin: 0 auto;
      object-fit: contain;
    }

    /* Left Navigation Button Styling */
    .spectre-post-container>nav .nav-scroll-wrapper a {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      width: 100%;
      box-sizing: border-box;
      padding: 0.9rem 1.5rem;
      margin-bottom: 0.5rem;
      border: 1px solid #4a4a4a;
      background-color: #1f1f1f;
      color: #ff8c8c;
      text-align: left;
      border-radius: 6px;
      font-family: "Orbitron", sans-serif;
      text-transform: uppercase;
      text-decoration: none;
      font-size: 1rem;
      font-weight: normal;
      transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, transform 0.2s ease-out, box-shadow 0.3s ease;
      flex-shrink: 0;
    }

    .spectre-post-container>nav .nav-scroll-wrapper a:hover {
      background-color: #ff4c4c;
      color: #0b0e13;
      border-color: #ff6a6a;
      transform: translateY(-2px);
      box-shadow: 0 5px 12px rgba(255, 76, 76, 0.3);
    }

    .spectre-post-container>nav .nav-scroll-wrapper a.nav-active {
      background: linear-gradient(to bottom, #ff4c4c, #d13b3b);
      color: #ffffff;
      border-color: #c02c2c;
      box-shadow: 0 3px 8px rgba(255, 76, 76, 0.4), inset 0 1px 3px rgba(0, 0, 0, 0.2);
      transform: translateY(0px);
      font-weight: bold;
    }

    .spectre-post-container>nav .nav-scroll-wrapper a.nav-active:hover {
      background: linear-gradient(to bottom, #ff6a6a, #ff4c4c);
      color: #ffffff;
      border-color: #d13b3b;
    }

    .spectre-post-container>nav .nav-scroll-wrapper a svg {
      fill: currentColor;
      width: 1em;
      height: 1em;
      margin-right: 0.8rem;
      vertical-align: middle;
      flex-shrink: 0;
    }

    /* Aside content styling */
    .aside-scroll-wrapper>.aside-top-logo {
      padding: 1rem 0;
      text-align: center;
      border-bottom: 1px solid #333;
      margin-bottom: 0;
      flex-shrink: 0;
    }

    .aside-scroll-wrapper>.aside-top-logo img {
      display: block;
      max-width: 180px;
      height: auto;
      margin: 0 auto 1rem;
      object-fit: contain;
    }

    .aside-scroll-wrapper>h2 {
      font-size: 1.1rem;
      color: #ff4c4c;
      text-transform: uppercase;
      margin: 0 0 0.5rem 0;
      padding: 1rem 0 0.5rem 0;
      border-bottom: 1px solid #333;
      flex-shrink: 0;
      font-family: "Orbitron", sans-serif;
    }

    .spectre-post-aside ul.aside-toc {
      list-style: none;
      padding: 0;
      margin: 0.5rem 0;
      flex-grow: 1;
      flex-shrink: 1;
      flex-basis: 0;
      overflow-y: auto;
      min-height: 80px;
    }

    .spectre-post-aside ul.aside-toc li {
      margin: 0;
    }

    .spectre-post-aside ul.aside-toc a {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      width: 100%;
      box-sizing: border-box;
      padding: 0.9rem 1.5rem;
      margin-bottom: 0.5rem;
      border: 1px solid #4a4a4a;
      background-color: #1f1f1f;
      color: #ff8c8c;
      text-align: left;
      border-radius: 6px;
      font-family: "Orbitron", sans-serif;
      text-transform: uppercase;
      text-decoration: none;
      font-size: 1rem;
      font-weight: normal;
      transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, transform 0.2s ease-out, box-shadow 0.3s ease;
      flex-shrink: 0;
    }

    .spectre-post-aside ul.aside-toc a:hover {
      background-color: #ff4c4c;
      color: #0b0e13;
      border-color: #ff6a6a;
      transform: translateY(-2px);
      box-shadow: 0 5px 12px rgba(255, 76, 76, 0.3);
    }

    .spectre-post-aside ul.aside-toc a.active {
      background: linear-gradient(to bottom, #ff4c4c, #d13b3b);
      color: #ffffff;
      border-color: #c02c2c;
      box-shadow: 0 3px 8px rgba(255, 76, 76, 0.4), inset 0 1px 3px rgba(0, 0, 0, 0.2);
      transform: translateY(0px);
      font-weight: bold;
    }

    .spectre-post-aside ul.aside-toc a.active:hover {
      background: linear-gradient(to bottom, #ff6a6a, #ff4c4c);
      color: #ffffff;
      border-color: #d13b3b;
    }

    .spectre-post-aside ul.aside-toc a svg {
      fill: currentColor;
      width: 1em;
      height: 1em;
      margin-right: 0.8rem;
      vertical-align: middle;
      flex-shrink: 0;
      opacity: 0.7;
      transition: opacity 0.3s ease;
    }

    .spectre-post-aside ul.aside-toc a:hover svg {
      opacity: 1;
    }

    .spectre-post-aside ul.aside-toc a.active svg {
      opacity: 1;
      color: #ffffff;
    }

    .aside-bio-section {
      padding: 1rem;
      border-top: 1px solid #333;
      margin-top: 1rem;
      flex-shrink: 0;
      color: #f0f0f0;
      font-size: 0.85rem;
      line-height: 1.5;
      background-color: rgba(255, 76, 76, 0.05);
      border-radius: 0 0 5px 5px;
    }

    .aside-bio-section .aside-bio-heading {
      font-size: 1rem !important;
      color: #ff8c8c !important;
      text-transform: uppercase;
      margin: 0 0 0.5rem 0 !important;
      padding: 0 0 0.3rem 0 !important;
      border-bottom: 1px dashed #444 !important;
      font-family: "Orbitron", sans-serif;
    }

    .aside-bio-content {
      max-height: 30vh;
      overflow-y: auto;
      padding-right: 0.5rem;
      scrollbar-width: thin;
      scrollbar-color: #ff4c4c #111;
    }

    .aside-bio-content::-webkit-scrollbar {
      width: 6px;
    }

    .aside-bio-content::-webkit-scrollbar-track {
      background: #1a1a1a;
    }

    .aside-bio-content::-webkit-scrollbar-thumb {
      background-color: #ff4c4c;
      border-radius: 3px;
      border: 1px solid #0b0e13;
    }

    /* Main content area */
    .spectre-post-container>.container {
      overflow-x: hidden;
      min-height: 0;
      padding: 1.5rem 2rem;
      box-sizing: border-box;
    }

    .spectre-post-container>.container>.section:first-child {
      margin-top: 0;
    }

    /* Content Responsiveness & Overflow Management */
    .spectre-post-container>.container img {
      max-width: 100%;
      height: auto;
      display: block;
    }

    #spectre-viewer-wrapper iframe {
      aspect-ratio: 4 / 3;
      height: auto;
    }

    /* General Content Styles */
    .spectre-post-container .container h2 {
      font-size: 1.8rem;
      color: #ff4c4c;
      text-transform: uppercase;
      font-family: "Orbitron", sans-serif;
      border-bottom: 1px solid #444;
      padding-bottom: 0.5rem;
      margin-top: 2rem;
      margin-bottom: 1.5rem;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    }

    .spectre-post-container .container h3 {
      font-size: 1.4rem;
      color: #ff8c8c;
      text-transform: uppercase;
      font-family: "Orbitron", sans-serif;
      border-bottom: 1px solid #333;
      padding-bottom: 0.3rem;
      margin-top: 1.5rem;
      margin-bottom: 1rem;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    }

    .spectre-post-container .container h4 {
      font-size: 1.2rem;
      color: #ffaaaa;
      font-family: "Orbitron", sans-serif;
      margin-top: 1.2rem;
      margin-bottom: 0.8rem;
    }
    
    /* (Other component styles remain here) */
    .spectre-post-container .container .section { background-color: rgba(255, 76, 76, 0.03); padding: 2rem; border-radius: 8px; margin-top: 2.5rem; border: 1px solid #2a2a2a; }


    /* ================================================= */
    /* === FINAL MEDIA QUERIES for All Screen Sizes === */
    /* ================================================= */

    /* --- STICKY HAMBURGER NAV STYLES --- */
    /* This media query targets tablets and mobile phones */
    @media (max-width: 767px) {

      /* Hide the main nav element from the grid flow */
      .spectre-post-container {
        grid-template-areas:
            "header"
            "content"
            "aside";
      }

      /* 1. Style the hamburger button */
      #mobile-nav-toggle {
        position: fixed;
        top: 15px;
        left: 15px;
        z-index: 2000; /* Ensures it's on top of everything */
        background-color: #ff4c4c;
        color: white;
        border: 1px solid #c02c2c;
        border-radius: 8px;
        width: 50px;
        height: 50px;
        font-size: 28px;
        line-height: 50px;
        text-align: center;
        cursor: pointer;
        display: block; /* Show the button */
      }

      /* 2. Style the menu overlay */
      #menu-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        z-index: 1000; /* Sits below the nav, above the content */
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease, visibility 0.3s ease;
      }

      /* 3. Reposition the Nav panel to be off-screen */
      .spectre-post-container > nav {
        position: fixed;
        top: 0;
        left: 0;
        height: 100vh;
        width: 300px; /* Give it a fixed width */
        max-width: 80%;
        z-index: 1500; /* Sits on top of the overlay */
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
      }

      /* 4. The "is-open" state for showing the menu */
      .spectre-post-container > nav.is-open {
        transform: translateX(0);
        box-shadow: 5px 0 15px rgba(0,0,0,0.5);
      }

      #menu-overlay.is-open {
        opacity: 1;
        visibility: visible;
      }
    }

    /* --- DESKTOP LAYOUT (Tablet & Larger) --- */
    /* Applies the fixed-height, independent-scrolling layout to all devices wider than 768px. */
    /* WARNING: This may cause content to be cut off on screens that are wide but not tall. */
    @media (min-width: 768px) {
      /* Hide the mobile-only elements */
      #mobile-nav-toggle, #menu-overlay {
          display: none;
      }
    
      html,
      body {
        overflow-y: hidden;
        /* Lock the main page scroll */
      }

      .spectre-post-container {
        height: 100vh; /* Use fixed viewport height */
        grid-template-areas:
          "header header header"
          "nav    content aside";
        grid-template-columns: 280px 1fr 280px; /* Three-column layout */
        grid-template-rows: auto 1fr;
      }

      /* Make the nav visible in its grid area */
      .spectre-post-container > nav {
        display: block;
        position: sticky; /* Let it stick to its grid area */
        top: 0;
        height: 100%;
        transform: translateX(0); /* Ensure it's not off-screen */
      }

      /* Enable internal scrolling on all three columns */
      .spectre-post-container > nav,
      .spectre-post-container > .container,
      .spectre-post-container > .spectre-post-aside {
        height: 100%;
        overflow-y: auto;
        position: sticky; /* Make them stick to the top of the 100vh container */
        top: 0;
        align-self: stretch;
      }
    }
  </style>
</head>

<body class="dynamic-load">
  <button id="mobile-nav-toggle" aria-label="Toggle Navigation">â˜°</button>
  <div id="menu-overlay"></div>

  <div class="spectre-post-container" id="spectre-top">
    <header>
      <h1>HFW Shadow Fleet - Comprehensive Design Document</h1>
      <p style="color: #aaaaaa; font-size: 0.9em; margin-top: 0.2em">
        Developed by Hephaestus Forge Works (An Anvil Aerospace Subsidiary)
      </p>
    </header>

    <nav>
      <div class="nav-scroll-wrapper">
        <div class="nav-logo nav-logo-top">
          <img alt="Made By The Community Logo" src="https://imagizer.imageshack.com/img922/7540/a21t3g.png" onerror="this.onerror=null;this.src='https://placehold.co/400x200/1a1a1a/ff4c4c?text=Anvil+Logo';" loading="lazy" width="400" height="200">
        </div>
        <a href="#spectre-concept-image"><svg fill="none" height="1em" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" stroke="currentColor" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><rect height="18" rx="2" ry="2" width="18" x="3" y="3"></rect><circle cx="9" cy="9" r="2"></circle><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"></path></svg>Gallery</a>
        <a href="#spectre-genesis"><svg fill="none" height="1em" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" stroke="currentColor" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M22 12h-6l-2 3h-4l-2-3H2"></path><path d="M5 12v6a3 3 0 0 0 3 3h8a3 3 0 0 0 3-3v-6"></path><path d="M18 3a3 3 0 0 0-3 3v6h4V6a3 3 0 0 0-3-3Z"></path><path d="M6 3a3 3 0 0 0-3 3v6h4V6a3 3 0 0 0-3-3Z"></path></svg>Genesis</a>
        <a href="#spectre-hfw-overview"><svg fill="none" height="1em" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" stroke="currentColor" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"></path></svg>HFW Overview</a>
        <a href="#spectre-founding-docs"><svg fill="none" height="1em" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" stroke="currentColor" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" x2="8" y1="13" y2="13"></line><line x1="16" x2="8" y1="17" y2="17"></line><line x1="3" x2="3.01" y1="6" y2="6"></line><line x1="3" x2="3.01" y1="12" y2="12"></line><line x1="3" x2="3.01" y1="18" y2="18"></line></svg>Founding Docs</a>
        <a href="#spectre-specs"><svg fill="none" height="1em" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" stroke="currentColor" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><line x1="8" x2="21" y1="6" y2="6"></line><line x1="8" x2="21" y1="12" y2="12"></line><line x1="8" x2="21" y1="18" y2="18"></line><line x1="3" x2="3.01" y1="6" y2="6"></line><line x1="3" x2="3.01" y1="12" y2="12"></line><line x1="3" x2="3.01" y1="18" y2="18"></line></svg>Specs</a>
        <a href="#spectre-variants"><svg fill="none" height="1em" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" stroke="currentColor" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11 17H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h6"></path><path d="M15 5h6a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-6"></path></svg>HFW Variants</a>
        <a href="#spectre-stealth-doctrine"><svg fill="none" height="1em" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" stroke="currentColor" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11 17H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h6"></path><path d="M15 5h6a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-6"></path></svg>Stealth</a>
        <a href="#spectre-scenarios"><svg fill="none" height="1em" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" stroke="currentColor" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" x2="8" y1="13" y2="13"></line><line x1="16" x2="8" y1="17" y2="17"></line><line x1="10" x2="8" y1="9" y2="9"></line></svg>Scenarios</a>
        <a href="#spectre-interior"><svg fill="none" height="1em" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" stroke="currentColor" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><rect height="18" rx="2" width="18" x="3" y="3"></rect><path d="M3 9h18"></path><path d="M9 21V9"></path></svg>Interior</a>
        <a href="#spectre-talent"><svg fill="none" height="1em" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" stroke="currentColor" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M22 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>Talent</a>
        <a href="#spectre-comparison"><svg fill="none" height="1em" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" stroke="currentColor" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12 3v18"></path><path d="M3.5 8.5v7"></path><path d="M20.5 12v-7"></path></svg>Comparison</a>
        <a href="#spectre-environment"><svg fill="none" height="1em" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" stroke="currentColor" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M21.2 15c.7-1.2 1-2.5.7-3.9-.6-2.4-2.4-4.2-4.8-4.8-.4-.1-.8-.2-1.2-.2-1.4-.1-2.7.1-3.9.7-1.2.6-2.2 1.4-3 2.4-.8 1-1.3 2.1-1.6 3.2C2 14.8 3.2 18 6.2 19.7c1 .6 2.1.9 3.2 1 .8.1 1.5 0 2.3-.2 1.1-.3 2.2-.8 3.1-1.5.9-.7 1.7-1.5 2.4-2.4.7-.9 1.2-2 1.5-3.1.2-.8.2-1.6 0-2.3z"></path><path d="M12 6V2"></path><path d="m4.9 4.9 2.8 2.8"></path><path d="M2 12h4"></path><path d="m4.9 19.1 2.8-2.8"></path><path d="M12 18v4"></path><path d="m19.1 19.1-2.8-2.8"></path><path d="M22 12h-4"></path><path d="m19.1 4.9-2.8 2.8"></path></svg>Environment</a>
        <a href="#spectre-testimonials"><svg fill="none" height="1em" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" stroke="currentColor" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"></path></svg>Testimonials</a>
        <a href="#revenant-acquisition"><svg class="feather feather-gitlab" fill="none" height="1em" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" stroke="currentColor" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M22.65 14.39L12 22.13 1.35 14.39a.84.84 0 0 1-.3-.94l1.22-3.78 2.44-7.59A4.28 4.28 0 0 1 8.09 2h7.82a4.28 4 0 0 1 3.06 1.64l2.44 7.59 1.22 3.78a.84.84 0 0 1-.3.94z"></path><line x1="10.53" x2="10.53" y1="20.24" y2="22.24"></line><line x1="13.47" x2="13.47" y1="20.24" y2="22.24"></line><line x1="16.41" x2="18.41" y1="18.23" y2="18.23"></line><line x1="5.59" x2="7.59" y1="18.23" y2="18.23"></line></svg>Revenant Acquisition</a>
        <a href="#spectre-conclusion"><svg fill="none" height="1em" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" stroke="currentColor" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>Conclusion</a>
      </div>
    </nav>

    <div class="container">
      <div class="section" id="spectre-viewer-wrapper">
        <iframe src="https://archkaine.github.io/HFW/modelviewer.html" style="width: 100%; border: none;" title="Interactive 3D Model Viewer" allow="fullscreen">
        </iframe>
      </div>
      <section>
        <div>
          <p align="center">
            My reflection is the following: I did this because it seemed like it would be a fun project, and so far it has been.
          </p>
        </div>
      </section>
    </div>

    <aside id="section-aside" class="spectre-post-aside">
      <div class="aside-scroll-wrapper">
        <div class="aside-top-logo">
          <img alt="Profile Logo" src="https://imagizer.imageshack.com/v2/834x1307q90/r/924/cy4z4L.png" onerror="this.onerror=null;this.src='https://placehold.co/180x100/1a1a1a/ff4c4c?text=Profile+Logo';" loading="lazy" width="180" height="100">
        </div>
        <h2>On This Section</h2>
        <ul class="aside-toc"></ul>
        <div class="aside-bio-section">
          <h2 class="aside-bio-heading">Dr. Aris D. Thorne: Visionary</h2>
          <div class="aside-bio-content">
            <p>
              <strong>Dr. Aris David Thorne</strong> (born 2910, Portland, Earth) is considered Anvil Aerospace's single most valuable person and asset...
            </p>
          </div>
        </div>
      </div>
    </aside>
  </div>

  <script>
    // --- Integrated Scripts ---

    document.addEventListener('DOMContentLoaded', () => {
      if (document.body.classList.contains('dynamic-load')) {
        console.log("Dynamic mode detected. Loading sections...");
        loadAllSections()
          .then(() => {
            console.log("All sections loaded.");
            initPageListeners();
          })
          .catch(error => {
            const mainContainer = document.querySelector(".container");
            mainContainer.innerHTML = `<div style="text-align: center; padding: 5rem 1rem; color: #ff4c4c;"><strong>Error:</strong> ${error.message}</div>`;
            console.error("Failed to load HFW content:", error);
          });
      } else {
        console.log("Static content detected. Initializing scripts...");
        initPageListeners();
      }
    });

    async function loadAllSections() {
        if (window.location.protocol === 'file:') {
            throw new Error(`Due to browser security, this page must be viewed on a web server.`);
        }
        const mainContainer = document.querySelector(".container");
        if (!mainContainer) throw new Error("Main content container not found.");
        // We assume sections.json and partials exist for the dynamic load
        try {
            const manifestResponse = await fetch('sections/sections.json');
            if (!manifestResponse.ok) throw new Error('Could not fetch sections.json.');
            const manifest = await manifestResponse.json();
            const fetchPromises = manifest.map(item => fetch(`sections/${item.filename}`).then(res => res.ok ? res.text() : Promise.reject(`Failed to load ${item.filename}`)));
            const results = await Promise.allSettled(fetchPromises);
            let finalHtml = results.map(r => r.status === 'fulfilled' ? r.value : `<div style="color:red;">Error loading a section.</div>`).join('\n');
            mainContainer.insertAdjacentHTML('beforeend', finalHtml);
        } catch (error) {
            console.error("Content loading failed:", error);
            mainContainer.insertAdjacentHTML('beforeend', `<div style="color:red;">${error.message}</div>`);
        }
    }

    let asideElement, mainContentScroller, spectreNavLinks;

    function initPageListeners() {
      asideElement = document.getElementById("section-aside");
      mainContentScroller = document.querySelector(".spectre-post-container > .container");
      spectreNavLinks = document.querySelectorAll('nav a[href^="#"]:not([href="#spectre-top"])');
      if (!mainContentScroller) return;
      const scrollOptions = { passive: true };
      window.addEventListener("scroll", handleSpectreNavScroll, scrollOptions);
      mainContentScroller.addEventListener("scroll", handleSpectreNavScroll, scrollOptions);
      window.addEventListener("scroll", updateAside, scrollOptions);
      mainContentScroller.addEventListener("scroll", updateAside, scrollOptions);
      window.addEventListener("resize", updateAside, scrollOptions);
      
      spectreNavLinks.forEach(link => {
        link.addEventListener('click', function(event) {
          event.preventDefault();
          const targetId = this.getAttribute('href');
          const targetSection = document.querySelector(targetId);
          if (targetSection) {
            targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
          }
        });
      });
      
      // --- STICKY HAMBURGER MENU LOGIC ---
      const navToggleBtn = document.getElementById('mobile-nav-toggle');
      const navPanel = document.querySelector('.spectre-post-container > nav');
      const menuOverlay = document.getElementById('menu-overlay');

      if (navToggleBtn && navPanel && menuOverlay) {
        const toggleMenu = () => {
          navPanel.classList.toggle('is-open');
          menuOverlay.classList.toggle('is-open');
        };

        navToggleBtn.addEventListener('click', toggleMenu);
        menuOverlay.addEventListener('click', toggleMenu);

        navPanel.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', toggleMenu);
        });
      }
      // --- END HAMBURGER MENU LOGIC ---

      updateAside();
      handleSpectreNavScroll();
    }

    function updateAside() {
      if (!asideElement || !mainContentScroller) return;
      const asideTocList = asideElement.querySelector("ul.aside-toc");
      if (!asideTocList) return;
      const svgIcon = '<svg viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor" style="vertical-align:-0.1em;margin-right:0.8em;opacity:0.7;"><path d="M10 17l5-5-5-5v10z"></path></svg>';
      const activationOffset = window.innerHeight * 0.35;
      const pageSections = Array.from(mainContentScroller.querySelectorAll(".section, div[id^='spectre-']"));
      let activeSection = null;
      for (let i = pageSections.length - 1; i >= 0; i--) {
        const sec = pageSections[i];
        if (sec.offsetParent === null) continue;
        if (sec.getBoundingClientRect().top < activationOffset) {
          activeSection = sec;
          break;
        }
      }
      asideTocList.innerHTML = "";
      if (!activeSection) return;
      
      const headings = Array.from(activeSection.querySelectorAll("h2, h3, h4"));
      headings.forEach(h => {
        if (!h.id) h.id = `hid-${Math.random().toString(36).substr(2, 9)}`;
        const a = document.createElement("a");
        a.href = `#${h.id}`;
        a.innerHTML = svgIcon + h.textContent.trim();
        a.onclick = (e) => { e.preventDefault(); h.scrollIntoView({behavior: 'smooth'}); };
        const li = document.createElement("li");
        li.appendChild(a);
        asideTocList.appendChild(li);
      });
    }

    function handleSpectreNavScroll() {
      if (!mainContentScroller || !spectreNavLinks) return;
      let currentNavId = "";
      const navActivationOffset = window.innerHeight * 0.4;
      spectreNavLinks.forEach(link => {
        const sectionId = link.getAttribute("href");
        const sec = sectionId.startsWith("#") ? document.getElementById(sectionId.substring(1)) : null;
        if (sec && sec.getBoundingClientRect().top < navActivationOffset) {
          currentNavId = sec.id;
        }
      });
      spectreNavLinks.forEach(link => {
        link.classList.toggle("nav-active", link.getAttribute("href") === `#${currentNavId}`);
      });
    }

  </script>
</body>
</html>
